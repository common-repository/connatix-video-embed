(()=>{var e={140:(e,t,r)=>{const{createElement:n,useEffect:a,useRef:s}=r(196);e.exports=function({html:e,dangerouslySetInnerHTML:t,allowRerender:r,...i}){const o=s(null),c=s(!0);return a((()=>{if(!e||!o.current)throw new Error("html prop can't be null");if(!c.current)return;c.current=Boolean(r);const t=document.createRange().createContextualFragment(e);o.current.innerHTML="",o.current.appendChild(t)}),[e,o]),n("div",{...i,ref:o})}},196:e=>{"use strict";e.exports=window.React}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(196);const t=window.wp.i18n,n=window.wp.blocks,a=window.wp.blockEditor,s=window.wp.components;var i=r(140),o=r.n(i);const c=t=>{const{embed_script:r="",change_state:n=(()=>{})}=t;return r.length<1?(0,e.createElement)("div",null," "):(0,e.createElement)("div",null,(0,e.createElement)(a.BlockControls,null,(0,e.createElement)(s.Toolbar,{label:"Options"},(0,e.createElement)(s.ToolbarButton,{label:"Edit Embed",icon:"admin-settings",onClick:()=>n("edit")}))),"Â ",(0,e.createElement)(o(),{html:r}))},d=(window.wp.element,t=>{const{embed_script:r="",close_modal:n=(()=>{}),update_embed:a=(()=>{})}=t;var i=jQuery("#cnx_frame_wrap iframe").attr("src");return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.Modal,{title:"Select Video",onRequestClose:n,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,overlayClassName:"connatix-embedded-overlay"},(0,e.createElement)("div",{id:"cnx_frame_wrap"},(0,e.createElement)("iframe",{src:i,id:"cnx_frame"}))))}),{Component:l}=wp.element;class m extends l{constructor(e){super(...arguments),this.props=e,this.state={isModalOpen:!1},this.open_modal=this.open_modal.bind(this),this.close_modal=this.close_modal.bind(this)}open_modal(e){if(void 0!==e&&!0===e){var t=jQuery("#cnx_frame_wrap iframe").attr("src"),r=new URL(t);r.searchParams.set("embed",encodeURIComponent(this.props.embed_script)),jQuery("#cnx_frame").attr("src",r.toString())}this.setState({isModalOpen:!0});var n=this;window.handle_script_select=function(e){n.props.update_embed(e.detail.script.script),n.close_modal()},window.document.addEventListener("cnx_plugin_insert_script",window.handle_script_select,!0)}close_modal(){window.document.removeEventListener("cnx_plugin_insert_script",window.handle_script_select,!0),this.setState({isModalOpen:!1});var e=jQuery("#cnx_frame_wrap iframe").attr("src"),t=new URL(e);t.searchParams.delete("embed"),jQuery("#cnx_frame").attr("src",t.toString())}render(){const{embed_script:r="",change_state:n=(()=>{}),update_embed:a=(()=>{})}=this.props;return(0,e.createElement)("div",null,(0,e.createElement)(s.Placeholder,{icon:"format-video",label:(0,t.__)("Connatix Video Embed","connatix-video-embed"),instructions:"Select the video to embed"},(0,e.createElement)("form",null,(0,e.createElement)(s.Button,{isPrimary:!0,variant:"primary",onClick:()=>this.open_modal()},(0,t.__)("Select Video","connatix-video-embed")),(0,e.createElement)(s.TextControl,{className:"embed-text-input",value:r,onChange:e=>a(e)}),r.length>0&&!1,r.length>0&&(0,e.createElement)(s.Button,{isPrimary:!0,variant:"primary",onClick:()=>n("preview")},(0,t.__)("Preview Video","connatix-video-embed")))),this.state.isModalOpen&&(0,e.createElement)(d,{embed_script:r,close_modal:this.close_modal,update_embed:this.update_embed}))}}const{Component:p}=wp.element;(0,n.registerBlockType)("cnx/video-embed",{title:"Connatix: Video Embed",icon:"format-video",category:"embed",attributes:{embed_script:{type:"string",default:""}},edit:class extends p{constructor(e){super(...arguments),this.props=e,this.state={view_state:"preview"},this.updateEmbedScript=this.updateEmbedScript.bind(this),this.change_state=this.change_state.bind(this),this.props.attributes.embed_script.length<1&&(this.state.view_state="edit")}change_state(e){this.setState({view_state:e})}updateEmbedScript(e){e=btoa(e),this.props.setAttributes({embed_script:e})}render(){const{className:t,attributes:{embed_script:r=""}={}}=this.props;return""==r&&"preview"==this.state.view_state&&this.change_state("edit"),"edit"==this.state.view_state?(0,e.createElement)("div",null,(0,e.createElement)(m,{embed_script:r,change_state:this.change_state,update_embed:this.updateEmbedScript})):"preview"==this.state.view_state?(0,e.createElement)("div",null,(0,e.createElement)(c,{embed_script:atob(r),change_state:this.change_state})):void 0}}})})()})();